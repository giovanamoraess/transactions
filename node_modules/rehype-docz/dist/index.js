"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var path=require("path"),is=_interopDefault(require("unist-util-is")),flatten=_interopDefault(require("lodash.flatten")),nodeToString=_interopDefault(require("hast-util-to-string")),doczUtils=require("docz-utils"),format=require("docz-utils/lib/format"),codesandbox=require("docz-utils/lib/codesandbox");const isPlayground=e=>"Playground"===e,addPropsOnPlayground=async(e,t,o,r,i)=>{const a=doczUtils.jsx.componentName(e.value),s=RegExp(`^\\<${a}`);if(isPlayground(a)){const n=(await format.format(nodeToString(e))).slice(1,1/0),l=`{props,${o.join(",")}}`,d=doczUtils.jsx.sanitizeCode(doczUtils.jsx.removeTags(n)),u=await codesandbox.getSandboxImportInfo(d,r,i);e.value=e.value.replace(s,`<${a} __position={${t}} __codesandbox={\`${u}\`} __code={\`${d}\`} __scope={${l}}`)}},addComponentsProps=(e,t,o)=>async(r,i)=>{await addPropsOnPlayground(r,i,e,t,o)};var index=e=>()=>(t,o)=>{const r=t.children.filter(e=>is("import",e)),i=flatten(r.map(doczUtils.imports.getFullImports)),a=flatten(r.map(doczUtils.imports.getImportsVariables)),s=path.relative(e,path.dirname(o.history[0])),n=t.children.filter(e=>is("jsx",e)).map(addComponentsProps(a,i,s));return Promise.all(n).then(()=>t)};exports.default=index;
